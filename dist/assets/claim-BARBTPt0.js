import{g as e}from"./bitcoin-utils-DDv8QE7C.js";/* empty css              */import{s as t,e as n}from"./bitcoin-CpxUx-D2.js";t.initEccLib(n);const o=document.getElementById("currentBlock"),l=document.getElementById("btnConnect"),a=document.getElementById("btnConnectPanel"),i=document.getElementById("btnLogout"),s=document.getElementById("statusText"),r=document.getElementById("nftStatus"),d=document.getElementById("introText"),c=document.getElementById("sparkClaimForm"),m=document.getElementById("sparkAddressInput"),p=document.getElementById("sparkError"),y=document.getElementById("submitSparkClaim");let u=null;const b=localStorage.getItem("taprootAddress"),g=localStorage.getItem("walletType");async function h(){try{let e,t=localStorage.getItem("walletType");if(t||(t=await new Promise(e=>{const t=document.createElement("div");t.innerHTML='\n        <div id="walletModalOverlay" style="\n            position:fixed;top:0;left:0;right:0;bottom:0;\n            background:rgba(0,0,0,0.85);backdrop-filter:blur(5px);\n            display:flex;justify-content:center;align-items:center;z-index:9999;">\n          <div style="background:#111;border:2px solid #f97316;border-radius:16px;padding:40px 30px;color:white;text-align:center;max-width:420px;width:90%;">\n            <h2 style="margin-bottom:20px;">ğŸ”— Select Wallet</h2>\n            <button id="chooseUnisat" style="width:80%;padding:14px;margin-bottom:12px;font-weight:700;background:#f97316;border:none;border-radius:8px;">ğŸ¦Š Unisat</button>\n            <button id="chooseXverse" style="width:80%;padding:14px;font-weight:700;background:#2b2b2b;border:1px solid #666;border-radius:8px;color:#fff;">ğŸŒ€ Xverse</button>\n          </div>\n        </div>',document.body.appendChild(t),t.querySelector("#chooseUnisat").onclick=()=>{t.remove(),e("unisat")},t.querySelector("#chooseXverse").onclick=()=>{t.remove(),e("xverse")},t.querySelector("#walletModalOverlay").onclick=n=>{"walletModalOverlay"===n.target.id&&(t.remove(),e(null))}})),!t)return;if("unisat"===t)e=(await window.unisat.requestAccounts())[0];else if("xverse"===t){const t=window?.XverseProviders?.BitcoinProvider,n=await t.request("wallet_connect",{network:"Mainnet",addresses:["ordinals"],message:"Connect to Spark Claim"});e=n.result?.addresses?.find(e=>"ordinals"===e.purpose)?.address}u=e,localStorage.setItem("walletType",t),localStorage.setItem("taprootAddress",e),w(e),k(e)}catch(e){f()}}function w(e){s.textContent=`âœ… Connected: ${e.slice(0,6)}...${e.slice(-6)}`,l.style.display="none",a.style.display="none",i.style.display="inline-block"}function f(){s.textContent="ğŸ”Œ Wallet not connected",l.style.display="inline-block",a.style.display="inline-block",i.style.display="none",c.classList.add("hidden"),d.style.display="block",r.textContent="ğŸ”Œ Wallet not connected."}async function k(e){r.textContent="ğŸ” Checking wallet...";try{const t=await fetch(`https://omrapi.vercel.app/check-holder?address=${e}`),n=await t.json();d.style.display="none",t.ok&&n.isHolder?(r.innerHTML=`\n            âœ… Eligible Wallet Detected<br>\n            <span style="color:#fff;font-weight:600;">ğŸ’° Claimable Spark:</span> \n            <span style="color:#ffb84d;">${n.total_claimable.toLocaleString()} RATNET</span>\n          `,c.classList.remove("hidden")):n.already_claimed?(r.textContent="ğŸ‰ Already claimed.",c.classList.add("hidden")):(r.textContent="ğŸš« No eligible claim found.",c.classList.add("hidden"))}catch(t){r.textContent="âš ï¸ Error checking wallet."}}async function x(){try{const t=await e();o.textContent=t.toLocaleString()}catch{}}b&&g&&(u=b,w(b),k(b)),l.onclick=h,a.onclick=h,i.onclick=()=>{localStorage.removeItem("taprootAddress"),localStorage.removeItem("walletType"),f()},m.addEventListener("input",()=>{m.value.trim().toLowerCase().startsWith("sp")?(p.style.display="none",y.disabled=!1):(p.style.display="block",y.disabled=!0)}),y.onclick=async()=>{const e=m.value.trim();if(e.toLowerCase().startsWith("sp")){r.textContent="â³ Submitting claim...";try{const t=await fetch("https://omrapi.vercel.app/submit-claim",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wallet:u,spark_address:e})}),n=await t.json();t.ok?(r.innerHTML="ğŸ‰ Claim submitted successfully!<br>Your Spark will arrive soon.",c.classList.add("hidden")):r.textContent="âŒ Claim failed: "+(n.error||"Unknown error")}catch(t){r.textContent="âš ï¸ Network error."}}else p.style.display="block"},x(),setInterval(x,3e4);
